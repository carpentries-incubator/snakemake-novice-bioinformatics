<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Snakemake for Bioinformatics: Processing lists of inputs</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/incubator/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/incubator/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/incubator/favicon-16x16.png"><link rel="manifest" href="../favicons/incubator/site.webmanifest"><link rel="mask-icon" href="../favicons/incubator/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><span class="badge text-bg-info">
          <abbr title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#polishing-beta-stage" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
              Beta
            </a>
            <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../06-expansion.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Snakemake for Bioinformatics
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Snakemake for Bioinformatics
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="B1-quoting.html">Extra Episode: Robust quoting in Snakefiles</a></li><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="prereqs.html">Prerequisites</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Snakemake for Bioinformatics
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 35%" class="percentage">
    35%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 35%" aria-valuenow="35" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../06-expansion.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Running commands with Snakemake</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-placeholders.html">2. Placeholders and wildcards</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-chaining_rules.html">3. Chaining rules</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-logs_and_errors.html">4. Complex outputs, logs and errors</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-the_dag.html">5. How Snakemake plans its jobs</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        6. Processing lists of inputs
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#defining-a-list-of-samples-to-process">Defining a list of samples to process</a></li>
<li><a href="#using-a-snakemake-rule-to-define-a-batch-of-outputs">Using a Snakemake rule to define a batch of outputs</a></li>
<li><a href="#rules-that-combine-multiple-inputs">Rules that combine multiple inputs</a></li>
<li><a href="#dynamically-determining-the-inputs">Dynamically determining the inputs</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-awkward_programs.html">7. Handling awkward programs</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-finished-workflow.html">8. Finishing the basic workflow</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-configuring.html">9. Configuring workflows</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-performance.html">10. Optimising workflow performance</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="11-conda_integration.html">11. Conda integration</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="12-assembly_challenge.html">12. Constructing a whole new workflow</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="13-cleaning_up.html">13. Cleaning up</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="B1-quoting.html">Extra Episode: Robust quoting in Snakefiles</a></li><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="prereqs.html">Prerequisites</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/05-the_dag.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/07-awkward_programs.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/05-the_dag.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: How Snakemake plans
        </a>
        <a class="chapter-link float-end" href="../instructor/07-awkward_programs.html" rel="next">
          Next: Handling awkward...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Processing lists of inputs</h1>
        <p>Last updated on 2024-10-10 |

        <a href="https://github.com/carpentries-incubator/snakemake-novice-bioinformatics/edit/main/episodes/06-expansion.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 80 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How do I define a default set of outputs for my Snakefile?</li>
<li>How do I make rules which combine whole lists of files?</li>
<li>How do I process all available input files at once?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Use Snakemake to process all our samples at once</li>
<li>Make a summary of all read counts</li>
</ul></div>
</div>
</div>
</div>
</div>
<p><em>For reference, <a href="../files/ep04.Snakefile">this is the
Snakefile</a> you should have to start the episode. We didn’t modify it
during the last episode.</em></p>
<section><h2 class="section-heading" id="defining-a-list-of-samples-to-process">Defining a list of samples to process<a class="anchor" aria-label="anchor" href="#defining-a-list-of-samples-to-process"></a></h2>
<hr class="half-width"><p>So far, we’ve told Snakemake what output files to generate by giving
the names of the desired files on the command line. Often you want
Snakemake to process all the available samples. How can we do this?</p>
<p>The <code>yeast/reads</code> directory contains results from three
conditions: <code>ref</code>, <code>etoh60</code> and
<code>temp33</code>. There are three replicates for each condition.
There is minor inconsistency in the naming convention, as the
<code>ref</code> files do not have an underscore before the replicate
number. Consistent naming is important for Snakemake, so let’s fix up
the names before we go any further.</p>
<p>A good way to do this is by making symlinks, because that way you
don’t lose sight of the original file names.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> mv reads original_reads</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">$</span> mkdir reads</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="ex">$</span> cd reads</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="ex">$</span> ln <span class="at">-s</span> ../original_reads/<span class="pp">*</span> .</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="ex">$</span> rename <span class="at">-v</span> <span class="at">-s</span> ref ref_ <span class="pp">*</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="ex">$</span> cd ..</span></code></pre>
</div>
<div id="file-renaming" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="file-renaming" class="callout-inner">
<h3 class="callout-title">File renaming</h3>
<div class="callout-content">
<p>The <strong>rename</strong> command here is <a href="https://plasmasturm.org/code/rename/" class="external-link">the one provided by
Bioconda</a>. Other Linux systems may have a different rename command
installed by default.</p>
</div>
</div>
</div>
<p>Having harmonized the file names we’ll tell Snakemake about our
conditions and replicates. To do this, we can define some lists as
Snakemake <strong>global variables</strong>.</p>
<p>Global variables should be added before the rules in the
Snakefile.</p>
<pre class="source"><code># Input conditions and replicates to process
CONDITIONS = ["ref", "etoh60", "temp33"]
REPLICATES = ["1", "2", "3"]</code></pre>
<ul><li>Unlike with variables in shell scripts, we can put spaces around the
<code>=</code> sign, but they are not mandatory.</li>
<li>The lists of quoted strings are enclosed in square brackets and
comma-separated. If you know any Python you’ll recognise this as Python
list syntax.</li>
<li>A good convention is to use capitalized names for these variables,
but this is not mandatory.</li>
<li>Although these are referred to as variables, you can’t actually
change the values once the workflow is running, so lists defined this
way are more like constants.</li>
</ul></section><section><h2 class="section-heading" id="using-a-snakemake-rule-to-define-a-batch-of-outputs">Using a Snakemake rule to define a batch of outputs<a class="anchor" aria-label="anchor" href="#using-a-snakemake-rule-to-define-a-batch-of-outputs"></a></h2>
<hr class="half-width"><p>We’ll add another rule to our Snakefile. This special target rule
will have an <code>input</code> section but no <code>output</code> or
<code>shell</code> sections (yet).</p>
<pre class="source"><code>rule all_counts:
    input: expand("trimmed.{cond}_{rep}_1.fq.count", cond=CONDITIONS, rep=REPLICATES)</code></pre>
<p>The <code>expand(...)</code> function in this rule generates a list
of filenames, by taking the first thing in the parentheses as a template
and replacing <a href="https://www.r-project.org" class="external-link">cond</a> with all the <code>CONDITIONS</code>
and <code>{rep}</code> with all the <code>REPLICATES</code>. Since there
are 3 of each, this will yield 9 combinations - ie. 9 files we want to
make.</p>
<p>This list goes into the <em>input</em> section of the rule. You might
think that since these filenames are outputs that we want from our
workflow they should go into the <em>output</em> section. However,
remember that <em>output</em>s of a rule are things the rule can make
itself, and this rule doesn’t actually make anything. It’s just a
placeholder for a bunch of filenames.</p>
<p>We now tell Snakemake to make all these files by using the <em>target
rule name</em> on the command line:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> snakemake <span class="at">-j1</span> <span class="at">-p</span> all_counts</span></code></pre>
</div>
<p>Here, Snakemake sees that <em>all_counts</em> is the name of a rule
in the Snakefile, so rather than trying to make a file literally named
<code>all_counts</code> it looks at all the input files for the rule and
tries to make them. In this case, all of the inputs to
<em>all_counts</em> can be made by the <em>countreads</em> rule, and all
of the inputs for those jobs are made by <em>trimreads</em>. The
resulting workflow is the same as if we had typed out all 9 of the
filenames on the command line.</p>
<p>If you don’t specify a target rule name or any file names on the
command line when running Snakemake, the default is to use <strong>the
first rule</strong> in the Snakefile as the target. So if
<em>all_counts</em> is defined at the top, before the other rules, you
can simply say:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">$</span> snakemake <span class="at">-j1</span> <span class="at">-p</span></span></code></pre>
</div>
<div id="rules-as-targets" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="rules-as-targets" class="callout-inner">
<h3 class="callout-title">Rules as targets</h3>
<div class="callout-content">
<p>Giving the name of a rule to Snakemake on the command line only works
when that rule has <em>no wildcards</em> in the outputs, because
Snakemake has no way to know what the desired wildcards might be. You
will see the error “Target rules may not contain wildcards.” This can
also happen when you don’t supply any explicit targets on the command
line at all, and Snakemake tries to run the first rule defined in the
Snakefile.</p>
</div>
</div>
</div>
<div id="counting-all-the-reads" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="counting-all-the-reads" class="callout-inner">
<h3 class="callout-title">Counting all the reads</h3>
<div class="callout-content">
<p>Check that the <em>all_counts</em> rule is working. Now adapt the
Snakefile so that it makes all the counts for both of the pairs of reads
(<code>_1.fq</code> and <code>_2.fq</code>), and also for both trimmed
and untrimmed versions of the files. So you should end up with 36 count
files in total.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>This will work.</p>
<pre class="source"><code># Input conditions and replicates to process
CONDITIONS = ["ref", "etoh60", "temp33"]
REPLICATES = ["1", "2", "3"]
READ_ENDS  = ["1", "2"]
COUNT_DIR  = ["reads", "trimmed"]

# Rule to make all counts at once
rule all_counts:
    input: expand("{indir}.{cond}_{rep}_{end}.fq.count", indir=COUNT_DIR, cond=CONDITIONS, rep=REPLICATES, end=READ_ENDS)</code></pre>
<p>Alternatively you can put the lists directly into the
<code>expand()</code> function rather than declaring more variables. To
aid readability of the code it’s also possible to split the function
over more than one line, but note that this only works if you put a
newline after the <code>input:</code> line too.</p>
<pre class="source"><code># Input conditions and replicates to process
CONDITIONS = ["ref", "etoh60", "temp33"]
REPLICATES = ["1", "2", "3"]

# Rule to make all counts at once
rule all_counts:
    input:
        expand( "{indir}.{cond}_{rep}_{end}.fq.count", indir = ["reads", "trimmed"],
                                                       cond  = CONDITIONS,
                                                       rep   = REPLICATES,
                                                       end   = ["1", "2"] )</code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="rules-that-combine-multiple-inputs">Rules that combine multiple inputs<a class="anchor" aria-label="anchor" href="#rules-that-combine-multiple-inputs"></a></h2>
<hr class="half-width"><p>Our <em>all_counts</em> rule is a rule which takes a list of input
files. The length of that list is not fixed by the rule, but can change
based on <code>CONDITIONS</code> and <code>REPLICATES</code>. If we want
to perform some combining operation on the whole list of files, we can
add <code>output</code> and <code>shell</code> sections to this
rule.</p>
<p>In typical bioinformatics workflows, the final steps will combine all
the results together into some big report. For our final workflow we’ll
be doing this with <em>MultiQC</em>, but as a simple first example,
let’s just concatenate all the count files. In the shell this would
be:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">$</span> cat file1.count file2.count file3.count ... <span class="op">&gt;</span> all_counts.txt</span></code></pre>
</div>
<p>In the Snakemake rule we just say:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">shell:</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="st">"cat {input} &gt; {output}"</span></span></code></pre>
</div>
<p>Within a rule definition you can combine named inputs and list inputs
- any named input can be list of files rather than just a single file.
When you use the <code>{input.name}</code> placeholder in the shell
command it will expand to the full list.</p>
<div id="combining-the-inputs-of-the-all_counts-rule" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="combining-the-inputs-of-the-all_counts-rule" class="callout-inner">
<h3 class="callout-title">Combining the inputs of the
<em>all_counts</em> rule</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Make it so that the <em>all_counts</em> rule concatenates all the
count files into a single output file named
<code>all_counts_concatenated.txt</code>.</li>
<li>Adapt the rule further so that there are two outputs named
<code>trimmed_counts_concatenated.txt</code> and
<code>untrimmed_counts_concatenated.txt</code>, and the respective
counts go into each.</li>
</ol><p><em>Hint: you can put two commands into the <code>shell</code> part,
separated by a semicolon <code>;</code>.</em></p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<pre class="source"><code>rule all_counts:
    input:
        expand( "{indir}.{cond}_{rep}_{end}.fq.count", indir = ["reads", "trimmed"],
                                                       cond  = CONDITIONS,
                                                       rep   = REPLICATES,
                                                       end   = ["1", "2"] )
    output:
        "all_counts_concatenated.txt"
    shell:
        "cat {input} &gt; {output}"</code></pre>
<pre class="source"><code>rule all_counts:
    input:
        untrimmed = expand( "reads.{cond}_{rep}_{end}.fq.count",   cond  = CONDITIONS,
                                                                   rep   = REPLICATES,
                                                                   end   = ["1", "2"] ),
        trimmed   = expand( "trimmed.{cond}_{rep}_{end}.fq.count", cond  = CONDITIONS,
                                                                   rep   = REPLICATES,
                                                                   end   = ["1", "2"] ),
    output:
        untrimmed = "untrimmed_counts_concatenated.txt",
        trimmed   = "trimmed_counts_concatenated.txt",
    shell:
        "cat {input.untrimmed} &gt; {output.untrimmed} ; cat {input.trimmed} &gt; {output.trimmed}"</code></pre>
<p>To run either version of the rule:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">$</span> snakemake <span class="at">-j1</span> <span class="at">-p</span> all_counts</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="dynamically-determining-the-inputs">Dynamically determining the inputs<a class="anchor" aria-label="anchor" href="#dynamically-determining-the-inputs"></a></h2>
<hr class="half-width"><p>In the shell we can match multiple filenames with <strong>glob
patterns</strong> like <code>original_reads/*</code> or
<code>reads/ref?_?.fq</code>. Snakemake allows you to do something
similar with the <code>glob_wildcards()</code> function, so we’ll use
this in our Snakefile.</p>
<pre class="source"><code>CONDITIONS = glob_wildcards("reads/{condition}_1_1.fq").condition
print("Conditions are: ", CONDITIONS)</code></pre>
<p>Here, the list of conditions is captured from the files seen in the
reads directory. The pattern used in <code>glob_wildcards()</code> looks
much like the input and output parts of rules, with a wildcard in {curly
brackets}, but here the pattern is being used to search for matching
files. We’re only looking for read 1 of replicate 1 so this will return
just three matches</p>
<p>Rather than getting the full file names, the function yields the
values of the wildcard, which we can assign directly to a list. The
<code>print()</code> statement will print out the value of
<code>CONDITIONS</code> when the Snakefile is run (including dry-run
mode, activated with the <code>-n</code> option as mentioned in <a href="02-placeholders.html">Episode 2</a>), and reassures us that the
list really is the same as before.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">$</span> snakemake <span class="at">-j1</span> <span class="at">-F</span> <span class="at">-n</span> <span class="at">-p</span> all_counts</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="ex">Conditions</span> are:  [<span class="st">'etoh60'</span>, <span class="st">'temp33'</span>, <span class="st">'ref'</span>]</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="ex">Building</span> DAG of jobs...</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="ex">Job</span> counts:</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>    <span class="ex">count</span>  jobs</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>    <span class="ex">1</span>      all_counts</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>    <span class="ex">36</span>     countreads</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>    <span class="ex">18</span>     trimreads</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>    <span class="ex">55</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="ex">...</span></span></code></pre>
</div>
<p>Using <code>glob_wildcards()</code> gets a little more tricky when
you need a more complex match. To refine the match we can quickly test
out results by activating the Python interpreter. This saves editing the
Snakefile and running Snakemake just to see what
<code>glob_wildcards()</code> will match.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>$ python3</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> snakemake.io <span class="im">import</span> glob_wildcards, expand</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> glob_wildcards(<span class="st">"reads/</span><span class="sc">{condition}</span><span class="st">_1_1.fq"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>Wildcards(condition<span class="op">=</span>[<span class="st">'etoh60'</span>, <span class="st">'temp33'</span>, <span class="st">'ref'</span>])</span></code></pre>
</div>
<p>This is the result we got before. So far, so good.</p>
<div id="the-python-interpreter" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="the-python-interpreter" class="callout-inner">
<h3 class="callout-title">The Python interpreter</h3>
<div class="callout-content">
<p>The Python interpreter is like a special shell for Python commands,
and is a familiar to anyone who has learned Python. Because Snakemake
functions are actually Python functions they can be run from the
interpreter after being imported.</p>
<p>Note that <code>&gt;&gt;&gt;</code> is the Python interpreter prompt,
and not part of the command to be typed. You can exit back to the
regular shell prompt by typing <code>exit()</code>. If you do exit and
then restart the interpreter, you will need to repeat the
<code>import</code> line.</p>
</div>
</div>
</div>
<div id="globbing-the-list-of-samples" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="globbing-the-list-of-samples" class="callout-inner">
<h3 class="callout-title">‘Globbing’ the list of samples</h3>
<div class="callout-content">
<p>Staying in the Python interpreter, use <code>glob_wildcards()</code>
to list the names of all nine samples, that is the three replicates of
each condition.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> glob_wildcards(<span class="st">"reads/</span><span class="sc">{sample}</span><span class="st">_1.fq"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>Wildcards(sample<span class="op">=</span>[<span class="st">'temp33_3'</span>, <span class="st">'temp33_2'</span>, <span class="st">'etoh60_1'</span>, <span class="st">'etoh60_3'</span>, <span class="st">'ref_2'</span>, <span class="st">'temp33_1'</span>, <span class="st">'etoh60_2'</span>, <span class="st">'ref_1'</span>, <span class="st">'ref_3'</span>])</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="globbing-the-list-of-samples" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="globbing-the-list-of-samples" class="callout-inner">
<h3 class="callout-title">‘Globbing’ the list of samples<em>
(continued)</em>
</h3>
<div class="callout-content">
<p>Still in the Python interpreter, use the <code>expand()</code>
function in combination with the <code>glob_wildcards()</code> to make a
list of all the count files, and then all the <em>kallisto_quant</em>
output files that would be generated for all the nine samples.</p>
<p>Remember you can save the result of <code>glob_wildcards()</code> to
a variable - this works the same way in the Python interpreter as it
does in the Snakefile.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> SAMPLES <span class="op">=</span> glob_wildcards(<span class="st">"reads/</span><span class="sc">{sample}</span><span class="st">_1.fq"</span>).sample</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expand(<span class="st">"</span><span class="sc">{indir}</span><span class="st">.</span><span class="sc">{sample}</span><span class="st">_</span><span class="sc">{end}</span><span class="st">.fq.count"</span>, indir<span class="op">=</span>[<span class="st">'reads'</span>, <span class="st">'trimmed'</span>], sample<span class="op">=</span>SAMPLES, end<span class="op">=</span>[<span class="st">"1"</span>,<span class="st">"2"</span>])</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>...</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> expand(<span class="st">"kallisto.</span><span class="sc">{sample}</span><span class="st">/</span><span class="sc">{outfile}</span><span class="st">"</span>, sample<span class="op">=</span>SAMPLES, outfile<span class="op">=</span>[<span class="st">'abundance.h5'</span>, <span class="st">'abundance.tsv'</span>, run_info.json<span class="st">'])</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="glob-with-multiple-wildcards" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="glob-with-multiple-wildcards" class="callout-inner">
<h3 class="callout-title">Glob with multiple wildcards</h3>
<div class="callout-content">
<p>If there are two or more wildcards in the glob pattern, dealing with
the result becomes a little more tricky, but it does work.</p>
<p>Here is one way to re-combine two wildcards using
<code>expand()</code> and <code>zip</code> (demonstrated in the Python
interpreter as above).</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>$ python3</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="im">from</span> snakemake.io <span class="im">import</span> glob_wildcards, expand</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> DOUBLE_MATCH <span class="op">=</span> glob_wildcards( <span class="st">"reads/</span><span class="sc">{condition}</span><span class="st">_</span><span class="sc">{samplenum}</span><span class="st">_1.fq"</span> )</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> DOUBLE_MATCH</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>Wildcards(condition<span class="op">=</span>[<span class="st">'temp33'</span>, <span class="st">'temp33'</span>, <span class="st">'etoh60'</span>, <span class="st">'etoh60'</span>, <span class="st">'ref'</span>, <span class="st">'temp33'</span>, <span class="st">'etoh60'</span>, <span class="st">'ref'</span>, <span class="st">'ref'</span>],</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>          samplenum<span class="op">=</span>[<span class="st">'3'</span>, <span class="st">'2'</span>, <span class="st">'1'</span>, <span class="st">'3'</span>, <span class="st">'2'</span>, <span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'1'</span>, <span class="st">'3'</span>])</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> SAMPLES <span class="op">=</span> expand(</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>...     <span class="st">"</span><span class="sc">{condition}</span><span class="st">_</span><span class="sc">{samplenum}</span><span class="st">"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>...     <span class="bu">zip</span>,</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>...     condition <span class="op">=</span> DOUBLE_MATCH.condition,</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>...     samplenum <span class="op">=</span> DOUBLE_MATCH.samplenum )</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> SAMPLES</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>[<span class="st">'temp33_3'</span>, <span class="st">'temp33_2'</span>, <span class="st">'etoh60_1'</span>, <span class="st">'etoh60_3'</span>, <span class="st">'ref_2'</span>, <span class="st">'temp33_1'</span>, <span class="st">'etoh60_2'</span>, <span class="st">'ref_1'</span>, <span class="st">'ref_3'</span>]</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">sorted</span>(SAMPLES)</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>[<span class="st">'etoh60_1'</span>, <span class="st">'etoh60_2'</span>, <span class="st">'etoh60_3'</span>, <span class="st">'ref_1'</span>, <span class="st">'ref_2'</span>, <span class="st">'ref_3'</span>, <span class="st">'temp33_1'</span>, <span class="st">'temp33_2'</span>, <span class="st">'temp33_3'</span>]</span></code></pre>
</div>
</div>
</div>
</div>
<div id="rules-that-make-multiple-outputs" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="rules-that-make-multiple-outputs" class="callout-inner">
<h3 class="callout-title">Rules that make multiple outputs</h3>
<div class="callout-content">
<p>If we can have rules that combine lists of files, can we do the
opposite and have a rule that produces a list of outputs?</p>
<p>The answer is yes, but the situation is not completely symmetrical.
Remember that Snakemake works out the full list of input and output
files to every job <em>before</em> it runs a single job in the workflow.
For a combining step, Snakemake will know how many samples/replicates
are being combined from the start. For a splitting step, it may or may
not be possible to predict the number of output files in advance. For
cases where you really do need to handle a dynamic list of outputs,
Snakemake has things called <a href="https://snakemake.readthedocs.io/en/stable/snakefiles/rules.html#data-dependent-conditional-execution" class="external-link">checkpoint
rules</a>.</p>
<p>In practise these are very rarely needed, so we’ll not be covering
them here in the course.</p>
</div>
</div>
</div>
<p><em>For reference, <a href="../files/ep06.Snakefile">this is a
Snakefile</a> incorporating the changes made in this episode.</em></p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Rename your input files if necessary to maintain consistent
naming</li>
<li>List the things you want to proces as global variables, or discover
input files with <code>glob_wildcards()</code>
</li>
<li>Use the <code>expand()</code> function to generate lists of
filenames you want to combine</li>
<li>These functions can be tested in the Python interpreter</li>
<li>Any <code>{input}</code> to a rule can be a variable-length
list</li>
<li>(But variable lists of outputs are trickier and rarely needed)</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/05-the_dag.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/07-awkward_programs.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/05-the_dag.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: How Snakemake plans
        </a>
        <a class="chapter-link float-end" href="../instructor/07-awkward_programs.html" rel="next">
          Next: Handling awkward...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries-incubator/snakemake-novice-bioinformatics/edit/main/episodes/06-expansion.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries-incubator/snakemake-novice-bioinformatics/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries-incubator/snakemake-novice-bioinformatics/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-incubator/snakemake-novice-bioinformatics/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:tim.booth@ed.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.11" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.7" class="external-link">pegboard (0.7.7)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries-incubator.github.io/snakemake-novice-bioinformatics/instructor/06-expansion.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Processing lists of inputs",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-incubator.github.io/snakemake-novice-bioinformatics/instructor/06-expansion.html",
  "identifier": "https://carpentries-incubator.github.io/snakemake-novice-bioinformatics/instructor/06-expansion.html",
  "dateCreated": "2021-03-26",
  "dateModified": "2024-10-10",
  "datePublished": "2025-01-28"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(["trackPageView"]);
          _paq.push(["enableLinkTracking"]);
          (function() {
              var u="https://matomo.carpentries.org/";
              _paq.push(["setTrackerUrl", u+"matomo.php"]);
              _paq.push(["setSiteId", "1"]);
              var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0];
              g.async=true; g.src="https://matomo.carpentries.org/matomo.js"; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

